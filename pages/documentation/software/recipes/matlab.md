---
title: MATLAB
tags: [Software, Module]
---

[MATLAB by MAthWorks](https://nl.mathworks.com/products/matlab.html){:target="_blank"} is a programming and numeric computing platform used by millions of engineers and scientists to analyze data, develop algorithms, and create models.

## Test MATLAB

Load the module(s)

```shell 
[user@umbrella]$ module purge
[user@umbrella]$ module load MATLAB/2024a_Update_3
```

Check if the licenses are availble:

```shell
[user@umbrella]$ matlab -dmlworker -nodisplay -r "ver;exit"
```

Output to screen should start with: 
```output
-----------------------------------------------------------------------------------------------------
MATLAB Version: 24.1.0.2603908 (R2024a) Update 3
MATLAB License Number: 284992
Operating System: Linux 4.18.0-513.11.1.el8_9.x86_64 #1 SMP Wed Jan 10 22:58:54 UTC 2024 x86_64
Java Version: Java 1.8.0_202-b08 with Oracle Corporation Java HotSpot(TM) 64-Bit Server VM mixed mode
-----------------------------------------------------------------------------------------------------
MATLAB                                                Version 24.1        (R2024a)
```

## SBATCH


## Example 1
To use Matlab, simply load the module. You do however need to pass some
parameters to run a script headless.

<div class="toccolours mw-collapsible mw-collapsed">
<div style="font-weight: bold; line-height: 1.6;">

`matlab.cmd`

</div>

    #!/usr/bin/bash
    #SBATCH --nodes=1
    #SBATCH --exclusive
    #SBATCH --partition=your.partition.q
    #SBATCH --output=slurm-%j.out
    #SBATCH --time=00:01:00

    module load matlab/current
    matlab -nodisplay -nojvm -nosplash -r "run('main.m'), quit"
    module unload matlab

</div>
<div class="toccolours mw-collapsible mw-collapsed">
<div style="font-weight: bold; line-height: 1.6;">

`main.m`

</div>

    fprintf('Hello, world!\n')

</div>

Run as `sbatch matlab.cmd`. You will notice the script reserves a full
compute node to run the Matlab script. This is because it does not seem
to be possible currently to restrict the number of cores Matlab will
use.


## Example 2
Please open a terminal and log in to the cluster.

If you want to run a script (a `*.m` file), you must first create/upload
the `*.m` file. You can write this file in the MATLAB editor either on
the cluster and save it directly, or on your own desktop and upload it
to the cluster. Secondly, you can write a wrapper script to call your
MATLAB script from the compute cluster. This wrapper file can be a
simple text file, containing the specifications of the job (number of
nodes, etc.), with a command to load the desired MATLAB module, and a
command to run the specified script. An example is given below. Note the
`-batch` argument, which specifies that the MATLAB module does not need
to be started visually, but in batch mode. Furthermore, please include
the `-singleCompThread` option, to limit the compute resources.

`#!/usr/bin/bash`
`#SBATCH --partition=tue.test.q`
`#SBATCH --output=openme.out`

`module load matlab/2018b`
`matlab -batch "myscript.m" -singleCompThread`

A wrapper such as this can be saved as a simple text file, for instance
`wrapper.txt`. To
[schedule](../../steps/jobs/index.md) the job like we did before], you simply
run:

```shell
sbatch wrapper.txt
```

Once the job completes, you will see that a file `openme.out` has been
created which contains the output generated by the MATLAB script.
