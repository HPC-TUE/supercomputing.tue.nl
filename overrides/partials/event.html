{% if not date_format %}
  {% set date_format = "full" %}
{% endif %}
{% set class = "event event-card md-typeset" %}
{% if page == post %}
  {% set class = class ~ " box" %}
{% endif %}
<article {% if post.config.scheme %} data-md-color-scheme="{{ post.config.scheme }}"{% endif %}>
  <div class="{{ class }}">
    <div class="event-header">
      {% if post.meta.hero and page != post or not post.meta.hero %}
        <div class="event-image">
          <div class="event-label">
            {% if post.config.draft %}
              <div class="badge badge--danger">{{ lang.t("blog.draft") }}</div>
            {% endif %}
            {% if post.config.end < now() %}
              <div class="badge badge--light">Past Event</div>
            {% endif %}
          </div>
          {% if post.config.image %}
            <img src="{{ post.config.image | trim("/") | url }}" alt="{{ post.title }}">
          {% endif %}
        </div>
      {% endif %}
      <div class="event-info">
        {% include "blog/title.html" %}
        <div class="event-meta">
          <ul class="event-meta__list">
            {% include "blog/meta/date.html" %}
            {% if post.config.start != post.config.end %}
              <li class="event-meta__item">
                <a title="Time" class="event-meta__title md-icon">
                  {% include ".icons/material/clock-outline.svg" %}
                </a>
                <time datetime="{{ post.config.time }}">
                  {{ post.config.start | date("HH:mm") }} - {{ post.config.end | date("HH:mm") }}
                </time>
              </li>
            {% endif %}
            {% if post.config.location %}
              <li class="event-meta__item">
                <a title="Location" class="event-meta__title md-icon">
                  {% include ".icons/material/map-marker.svg" %}
                </a>
                {% if post.config.location_url %}
                  <a href="{{ post.config.location_url }}" target="_blank">{{ post.config.location }}</a>
                {% else %}
                  {{ post.config.location }}
                {% endif %}
              </li>
            {% endif %}
            {% if post.config.price != None %}
              <li class="event-meta__item">
                <a title="Price" class="event-meta__title md-icon">
                  {% include ".icons/material/currency-eur.svg" %}
                </a>
                {% if post.config.price == 0.0 %}
                  Free
                {% else %}
                  {{ post.config.price | replace(".", ",") }}
                {% endif %}
              </li>
            {% endif %}
            {% if post.config.speakers %}
              <li class="event-meta__item">
                <a title="Speakers" class="event-meta__title md-icon">
                  {% include ".icons/material/bullhorn.svg" %}
                </a>
                <ul class="author__list">
                  {% for speaker in post.config.speakers %}
                    <li class="author__item">
                      {% if speaker.url %}
                        <a class="author__link" title="{{ speaker.name }}" href="{{ speaker.url | url }}" target="_blank">
                          <img src="{{ speaker.avatar | trim("/") | url }}" alt="{{ speaker.name }}"/>
                        </a>
                      {% else %}
                        <a class="author__link" title="{{ speaker.name }}">
                          <img src="{{ speaker.avatar | trim("/") | url }}" alt="{{ speaker.name }}"/>
                        </a>
                      {% endif %}
                    </li>
                  {% endfor %}
                </ul>
              </li>
            {% endif %}
            <li style="margin-left: auto;">
              <ul class="md-meta__list">
                {% if post.config.pin %}
                  <li class="event-meta__item" style="rotate: 45deg;">
                    <div class="md-icon">
                      {% include ".icons/material/pin.svg" %}
                    </div>
                  </li>
                {% endif %}
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="event__content">
      {% if page == post or not post.excerpt %}
        {{ post.content | strip_tags(['h1']) }}
      {% elif post.excerpt and show_content|default(True) %}
        {{ post.excerpt.content | strip_tags(['h1']) }}
      {% endif %}
      {% if post.config.registration.enabled %}
        {% if post.config.registration.description %}
          <h5 style="grid-column: 1 / -1;text-align: center">{{ post.config.registration.description }}</h5>
        {% endif %}
        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(min(100%, 6rem), 1fr))">
          <ul style="display: contents">
            {% for option in post.config.registration.options %}
              <li style="display: block; text-align: center; margin: 0; padding: 0">
                <div style="display: grid; justify-content: center; text-align: center">
                  <a class="md-button md-button--primary" href="{{ option.url }}" target="_blank">
                    {{ option.title }}
                  </a>
                  {% if option.qr %}
                    <img src="{{ option.qr_url | url }}" alt="{{ option.title }}" style="width: 175px;margin: .1rem auto;background-color: #ffffff;"/>
                  {% endif %}
                </div>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
      {% if post.config.sponsors %}
        <ul class="event-meta__list" style="float: right;">
          <li class="event-meta__title" style="justify-content: right">
            <div style="font-weight: 700;">Supported by</div>
          </li>
          <li class="event-meta__item" style="justify-content: right;float: right;">
            <ul class="sponsor__list">
              {% for sponsor in post.config.sponsors %}
                <li class="sponsor__item">
                  {% if sponsor.url %}
                    <a class="sponsor__link" title="{{ sponsor.name }}" href="{{ sponsor.url | url }}" target="_blank">
                      <img src="{{ sponsor.avatar | trim("/") | url }}" alt="{{ sponsor.name }}"/>
                    </a>
                  {% else %}
                    <a class="sponsor__link" title="{{ sponsor.name }}">
                      <img src="{{ sponsor.avatar | trim("/") | url }}" alt="{{ sponsor.name }}"/>
                    </a>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </li>
        </ul>
      {% endif %}
    </div>
  </div>
</article>

{% if page == post %}
  <h2>Related Events</h2>
  <div class="grid cards">
    <ul>
      {% for post in page.blog.posts if page != post and post.config.type == page.config.type and page.config.categories|first in post.config.categories %}
        {% if landing %}
          {% set post_url = "/" ~ post.url %}
        {% endif %}
        <li>{% include "partials/event.html" %}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}